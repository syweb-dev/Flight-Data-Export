# Flight Data Export (MSFS 2020/2024)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

>This project provides a local panel to read real-time aircraft data from Microsoft Flight Simulator 2020/2024 and display it on a local web page.
## Introduction

* Partially created using AI
* The following documentation was generated by AI
* Currently untested; the project is in beta testing
* Developer's personal website: [lucanex.top](https://www.lucanex.top/)

## üìÑ License

This project is licensed under the [MIT License](LICENSE), allowing free use, modification, and distribution. For more details, please refer to the [LICENSE](LICENSE) file.
We encourage, but do not require, you to retain the original author's copyright notice and license information when using part or all of the code in this project.

## Features
- GUI panel: one-click start, real-time altitude/heading/speed and more
- Web export: local site at `127.0.0.1:8989`
- SimConnect / FSUIPC7 support (SimConnect first, FSUIPC7 fallback)

## File Map
- `gui.py`: main app (UI + data collection + web server + firewall rule)
- `index.html`: web UI
- `style.css`: web styles
- `port.txt`: service port
- `fsuipc_offsets.json`: FSUIPC offset config
- `notice_flag.txt`: ‚Äúdon‚Äôt show again‚Äù flag
- `SDK/`: FSUIPC SDK files
- `open_port.bat`: firewall port rule (interactive)
- `install_Dependency.bat`: installs SimConnect + pyuipc


## Languages
- App UI languages are configured in `gui-lang.json` (Simplified Chinese / Traditional Chinese / English).
- Web UI languages are configured in `html-lang.json`.
- The selected language is saved locally (app: `language.txt`, web: browser localStorage).

## How to Run
1. Start the GUI panel:
   ```bash
   python gui.py
   ```
2. Click ‚ÄúStart Parsing‚Äù
3. Click ‚ÄúExport to Web‚Äù and open `http://127.0.0.1:8989`

## SimConnect Notes
- When you click ‚ÄúStart Parsing‚Äù, the app tries SimConnect first
- If SimConnect is unavailable, it falls back to FSUIPC7 (pyuipc)
- If both are unavailable, it shows ‚ÄúUnable to parse‚Äù

## FSUIPC7 Notes
- Install FSUIPC7 and enable the WASM module
- Install pyuipc from the SDK 
- Offsets are configurable in `fsuipc_offsets.json`

## Install SimConnect (MSFS 2020/2024)
SimConnect is the official data interface for MSFS. MSFS 2020/2024 usually ships with SimConnect, you only need to install it.

Common paths (pick one):
1. **Install via MSFS SDK**
   Enable Developer Mode in-game, install the SDK, then run `SimConnect.msi` from the SDK folder.
2. **Install from game packages**
   Locate and run `SimConnect.msi` in the following paths (may vary by install location):
   - Microsoft Store: `Packages\Official\OneStore\fs-base\SimConnect.msi`
   - Steam: `Packages\Official\Steam\fs-base\SimConnect.msi`

After that, install Python dependencies:
```bash
pip install SimConnect
```
```bash
pip install pyuipc
```

## If SimConnect.msi Cannot Be Found
If full-disk search still cannot find `SimConnect.msi`, install via SDK (works for 2020/2024):
1. MSFS 2020/2024 ‚Üí Options ‚Üí General ‚Üí Developers ‚Üí enable Developer Mode.
2. Use the SDK installer in the top menu.
3. Run `SimConnect.msi` from the SDK folder.

If it still cannot be found:
- Make sure MSFS 2020/2024 is fully installed and updated (`fs-base` must exist).
- Check the Content Manager and confirm the base package is installed.
- Repair/verify the game install and search again.

## MSFS 2020/2024 Installation Note
This is an **external program/panel** (single `gui.py`, compatible with 2020/2024). You do not need to put any files into the MSFS ‚ÄúCommunity‚Äù folder.

Usage:
1. Launch MSFS 2020/2024 and start a flight.
2. Run `python gui.py` in this folder.
3. The app reads data via SimConnect (or FSUIPC7 fallback) and exports to the web page.

## Helper Scripts
- `find_simconnect.bat`: choose Steam/Store and search for `SimConnect.msi`
- `install_simconnect.bat`: runs `pip install SimConnect`
- `open_port.bat`: prompt for a port and add a firewall rule

## Build Executable (Windows)
To run on machines without Python, use PyInstaller.

1. Install Python and pip (check ‚ÄúAdd Python to PATH‚Äù on Windows).
2. Install PyInstaller:
   ```bash
   pip install pyinstaller
   ```
3. Build:
   ```bash
   pyinstaller --noconsole --onefile gui.py
   ```
4. The executable will be in `dist/gui.exe`.

Notes:
- Keep `index.html` and `style.css` next to `gui.exe` for web UI styling.
- If using SimConnect, install the SimConnect runtime on the target machine.

## Firewall (for Mobile Access)
If your phone cannot access `http://PC_IP:8989`, check firewall rules.

The app tries to auto-open the port from `port.txt` on startup (Windows will prompt for admin permission). If access fails, confirm you accepted the UAC prompt.

Windows suggestions:
1. Run `open_port.bat` as Administrator.
2. Windows Security ‚Üí Firewall & network protection ‚Üí Allow an app through firewall.
3. Allow `python.exe` or `gui.exe` on Private networks, or add an inbound rule for TCP port `8989`.

Also ensure:
- Phone and PC are on the same LAN (same Wi‚ÄëFi).
- Router guest isolation (AP isolation) is disabled.

## Version

- 0.1.0: Basic functionality implemented, adapted for MSFS2020/2024


